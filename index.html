<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YouTube Audio "Spotify" UI</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Circular+Sp:wght@300;400;500;600;700&display=swap');
    
    * {
      box-sizing: border-box;
    }
    
    body { 
      margin: 0; 
      font-family: 'Circular Sp', -apple-system, BlinkMacSystemFont, sans-serif; 
      background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
      color: #fff; 
      overflow-x: hidden;
      min-height: 100vh;
    }
    
    /* Animated background particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 80%, rgba(29, 185, 84, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(29, 185, 84, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.02) 0%, transparent 50%);
      pointer-events: none;
      animation: backgroundFloat 20s ease-in-out infinite;
    }
    
    @keyframes backgroundFloat {
      0%, 100% { opacity: 1; transform: translateY(0px); }
      50% { opacity: 0.8; transform: translateY(-10px); }
    }

    .container { 
      max-width: 900px; 
      margin: 0 auto; 
      padding: 40px 20px 120px; 
      position: relative;
      z-index: 1;
    }
    
    h1 { 
      text-align: center; 
      margin-bottom: 40px; 
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(45deg, #1DB954, #1ed760, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px rgba(29, 185, 84, 0.3);
      animation: titleGlow 3s ease-in-out infinite alternate;
    }
    
    @keyframes titleGlow {
      from { filter: drop-shadow(0 0 10px rgba(29, 185, 84, 0.3)); }
      to { filter: drop-shadow(0 0 20px rgba(29, 185, 84, 0.6)); }
    }

    .search-bar { 
      display: flex; 
      margin-bottom: 40px; 
      position: relative;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .search-bar::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, #1DB954, #1ed760, #fff, #1DB954);
      border-radius: 30px;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
      animation: borderRotate 3s linear infinite;
    }
    
    .search-bar:hover::before {
      opacity: 1;
    }
    
    @keyframes borderRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .search-bar input {
      flex: 1; 
      padding: 18px 25px; 
      font-size: 16px;
      border: none; 
      border-radius: 25px 0 0 25px;
      background: rgba(40, 40, 40, 0.9);
      color: #fff;
      backdrop-filter: blur(20px);
      transition: all 0.3s ease;
    }
    
    .search-bar input:focus {
      outline: none;
      background: rgba(60, 60, 60, 0.95);
      transform: scale(1.02);
      box-shadow: 0 0 25px rgba(29, 185, 84, 0.3);
    }
    
    .search-bar input::placeholder {
      color: #888;
      transition: color 0.3s ease;
    }
    
    .search-bar input:focus::placeholder {
      color: #aaa;
    }
    
    .search-bar button {
      padding: 18px 30px; 
      font-size: 16px;
      border: none; 
      background: linear-gradient(45deg, #1DB954, #1ed760);
      color: #fff;
      border-radius: 0 25px 25px 0; 
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .search-bar button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }
    
    .search-bar button:hover::before {
      left: 100%;
    }
    
    .search-bar button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(29, 185, 84, 0.4);
    }
    
    .search-bar button:active {
      transform: translateY(0);
    }

    #results { 
      list-style: none; 
      padding: 0; 
      margin: 0; 
      background: rgba(18, 18, 18, 0.8);
      border-radius: 20px;
      backdrop-filter: blur(20px);
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }
    
    #results li {
      padding: 20px 25px; 
      border-bottom: 1px solid rgba(51, 51, 51, 0.3);
      cursor: pointer; 
      display: flex; 
      align-items: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    #results li::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(29, 185, 84, 0.1), transparent);
      transition: left 0.4s ease;
    }
    
    #results li:hover::before {
      left: 100%;
    }
    
    /* keep the row background on hover, but don‚Äôt shift the whole <li> */
#results li:hover {
  background: rgba(29, 185, 84, 0.1);
  box-shadow: inset 4px 0 0 #1DB954;
}

/* allow the title text to slide without hiding the ‚ÄúÔºã‚Äù button */
#results li span {
  display: inline-block;
  transition: transform 0.3s ease;
}
#results li:hover span {
  transform: translateX(10px);
}

/* ensure the add‚Äêto‚Äêplaylist button stays put */
.add-to-playlist {
  margin-left: auto;
  background: none;
  border: none;
  color: #1DB954;
  font-size: 20px;
  cursor: pointer;
  z-index: 2;
}

    
    #results li:last-child {
      border-bottom: none;
    }
    
    #results li::after {
      content: '‚ñ∂';
      position: absolute;
      right: 25px;
      opacity: 0;
      transition: all 0.3s ease;
      color: #1DB954;
      font-size: 18px;
    }
    
    #results li:hover::after {
      opacity: 1;
      transform: translateX(-5px);
    }
    
    #results li span { 
      margin-left: 15px; 
      overflow: hidden; 
      text-overflow: ellipsis; 
      white-space: nowrap; 
      font-weight: 500;
      flex: 1;
    }
    
    #results li::before {
      content: 'üéµ';
      font-size: 18px;
      margin-right: 10px;
    }

    /* hidden YouTube iframe */
    #yt-player { width: 0; height: 0; overflow: hidden; }

    /* bottom "Spotify" bar */
    .player-bar {
      position: fixed; 
      bottom: 0; 
      left: 0; 
      right: 0;
      background: linear-gradient(135deg, rgba(40, 40, 40, 0.95), rgba(20, 20, 20, 0.95));
      backdrop-filter: blur(20px);
      padding: 20px 30px;
      display: flex; 
      align-items: center; 
      z-index: 100;
      border-top: 1px solid rgba(29, 185, 84, 0.2);
      box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3);
      
    }
    
    .track-info {
      flex: 1; 
      overflow: hidden; 
      white-space: nowrap;
      text-overflow: ellipsis; 
      font-weight: 600;
      font-size: 16px;
      color: #fff;
      animation: trackSlide 15s linear infinite;
    }
    
    @keyframes trackSlide {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50px); }
    }
    
    .controls { 
      display: flex; 
      align-items: center; 
      margin: 0 30px;
    }
    
    .controls button {
      background: linear-gradient(45deg, #1DB954, #1ed760);
      border: none; 
      color: #fff;
      font-size: 24px; 
      margin: 0 15px; 
      cursor: pointer;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(29, 185, 84, 0.3);
    }
    
    .controls button:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 25px rgba(29, 185, 84, 0.5);
    }
    
    .controls button:active {
      transform: scale(0.95);
    }
    
    .progress-container {
      flex: 2; 
      margin: 0 20px; 
      cursor: pointer;
      position: relative;
    }
    
    .progress {
      width: 100%; 
      height: 6px; 
      background: rgba(85, 85, 85, 0.5);
      border-radius: 3px; 
      position: relative;
      overflow: hidden;
    }
    
    .progress::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(29, 185, 84, 0.2), transparent);
      animation: progressShimmer 2s ease-in-out infinite;
    }
    
    @keyframes progressShimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .progress .bar {
      height: 100%; 
      width: 0%; 
      background: linear-gradient(90deg, #1DB954, #1ed760);
      border-radius: 3px;
      position: relative;
      transition: width 0.1s ease;
    }
    
    .progress .bar::after {
      content: '';
      position: absolute;
      right: -6px;
      top: -3px;
      width: 12px;
      height: 12px;
      background: #fff;
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    
    .progress-container:hover .bar::after {
      opacity: 1;
    }
    
    .time { 
      font-size: 14px; 
      width: 60px; 
      text-align: center; 
      font-weight: 500;
      color: #b3b3b3;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 20px 15px 140px;
      }
      
      h1 {
        font-size: 2rem;
        margin-bottom: 30px;
      }
      
      .search-bar {
        margin-bottom: 30px;
      }
      
      .search-bar input,
      .search-bar button {
        padding: 15px 20px;
        font-size: 14px;
      }
      
      #results li {
        padding: 15px 20px;
      }
      
      .player-bar {
        padding: 15px 20px;
        flex-wrap: wrap;
      }
      
      .track-info {
        flex-basis: 100%;
        margin-bottom: 10px;
        text-align: center;
      }
      
      .controls {
        margin: 0 15px;
      }
      
      .controls button {
        width: 50px;
        height: 50px;
        font-size: 20px;
        margin: 0 10px;
      }
      
      .progress-container {
        flex: 1;
        margin: 0 10px;
      }
      
      .time {
        width: 50px;
        font-size: 12px;
      }
    }
    
    /* Loading Animation */
    .search-loading {
      text-align: center;
      padding: 40px;
      color: #888;
    }
    
    .search-loading::after {
      content: '';
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #1DB954;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
      margin-left: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Enhanced scroll bar */
    ::-webkit-scrollbar {
      width: 12px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(18, 18, 18, 0.5);
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(45deg, #1DB954, #1ed760);
      border-radius: 6px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(45deg, #1ed760, #1DB954);
    }
    /* ‚Üì NEW PLAYER-BAR CONTROLS CSS ‚Üì */
.player-bar button#prev-track,
.player-bar button#next-track,
.player-bar button#shuffle,
.player-bar button#repeat,
.player-bar button#favorite {
  margin: 0 5px;
  padding: 0;
}
#volume-slider {
  width: 100px;
  margin-left: 15px;
  vertical-align: middle;
}
/* ‚Üë END NEW CSS ‚Üë */
.playlist-container {
  max-width: 600px;
  margin: 20px auto;
  background: rgba(18,18,18,0.85);
  border-radius: 12px;
  padding: 15px;
  backdrop-filter: blur(20px);
}
.playlist-container h2 {
  margin: 0 0 10px;
  font-size: 1.2rem;
  color: #1DB954;
}
#playlist {
  list-style: none;
  margin: 0;
  padding: 0;
  max-height: 200px;
  overflow-y: auto;
}
#playlist li {
  display: flex;
  justify-content: space-between;
  padding: 8px 12px;
  border-bottom: 1px solid rgba(51,51,51,0.3);
  cursor: pointer;
}
#playlist li:last-child { border-bottom: none; }
#playlist li:hover { background: rgba(29,185,84,0.1); }
#playlist li .remove {
  color: #f66;
  font-weight: bold;
  margin-left: 10px;
}

  </style>
</head>
<body>
  <div class="container">
    <h1>YouTube Audio Player</h1>
    <div class="search-bar">
      <input id="search-input" placeholder="Search songs, artists, albums‚Ä¶" />
      <button id="search-btn">Search</button>
    </div>
    <div class="playlist-container">
  <h2>Your Playlist</h2>
  <ul id="playlist"></ul>
</div>
    <ul id="results"></ul>
  </div>

  <!-- hidden iframe -->
  <div id="yt-player"></div>

  <!-- bottom bar -->
  <div class="player-bar">
    <div class="track-info" id="track-title">No track selected</div>
    <div class="controls">
  <button id="play-pause">‚ñ∂Ô∏è</button>
  <!-- ‚Üì ADD HERE ‚Üì -->
  <button id="prev-track">‚èÆÔ∏è</button>
  <button id="next-track">‚è≠Ô∏è</button>
  <button id="shuffle" style="opacity:0.5;">üîÄ</button>
  <button id="repeat" style="opacity:0.5;">üîÅ</button>
  <input type="range" id="volume-slider" min="0" max="100" value="100">
  <button id="favorite">‚≠ê</button>
  <!-- ‚Üë END ADD ‚Üë -->
</div>
    <div class="time" id="current-time">0:00</div>
    <div class="progress-container" id="progress-container">
      <div class="progress"><div class="bar" id="progress-bar"></div></div>
    </div>
    <div class="time" id="duration">0:00</div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    const API_KEY    = 'AIzaSyCMkZ4GN-lPae8CG2OKgnl6Ugk7O-LcWHU';
    const SEARCH_URL = 'https://www.googleapis.com/youtube/v3/search';

    const inputEl  = document.getElementById('search-input');
    const btn      = document.getElementById('search-btn');
    const results  = document.getElementById('results');
    const titleEl  = document.getElementById('track-title');
    const playBtn  = document.getElementById('play-pause');
    const currTime = document.getElementById('current-time');
    const durTime  = document.getElementById('duration');
    const progBar  = document.getElementById('progress-bar');
    const progCont = document.getElementById('progress-container');

    let player, currentVideoId, isPlaying = false;

    // Load YouTube IFrame API & create hidden player
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('yt-player', {
        height: '0', width: '0',
        playerVars: { autoplay: 0, controls: 0, disablekb: 1, playsinline: 1 },
        events: {
          onReady: () => {},
          onStateChange: onPlayerStateChange
        }
      });
    }

    btn.onclick = async () => {
        
      const q = inputEl.value.trim();
       if (!q) {
    results.innerHTML = '';
    return;
  }
      
      // Add loading state
      results.innerHTML = '<li class="search-loading">Searching for music...</li>';
      
      try {
        const res = await fetch(
          `${SEARCH_URL}?part=snippet&type=video&maxResults=10`
          + `&q=${encodeURIComponent(q)}&key=${API_KEY}`
        );
        const { items } = await res.json();
        
        // Clear loading
        results.innerHTML = '';
        
        if (!items?.length) {
          results.innerHTML = '<li style="text-align: center; color: #888; padding: 40px;">No results found. Try a different search term.</li>';
          return;
        }
        
        items.forEach((item, index) => {
          const li = document.createElement('li');
           li.innerHTML = `
    <span>${item.snippet.title}</span>
    <button class="add-to-playlist">Ôºã</button>
  `;

          li.onclick = () => loadTrack(item.id.videoId, item.snippet.title);
          const addBtn = li.querySelector('.add-to-playlist');
  addBtn.onclick = e => {
    e.stopPropagation();
    playlist.push({ id: item.id.videoId, title: item.snippet.title });
    renderPlaylist();
  };
          // Add stagger animation
          li.style.opacity = '0';
          li.style.transform = 'translateY(20px)';
          li.style.animation = `fadeInUp 0.5s ease forwards ${index * 0.1}s`;
          
          results.appendChild(li);
        });
      } catch (err) {
        console.error(err);
        results.innerHTML = '<li style="text-align: center; color: #ff6b6b; padding: 40px;">Search failed. Please try again.</li>';
      }
    };

    // Add CSS for fade in animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    `;
    document.head.appendChild(style);

    function loadTrack(videoId, title) {
      currentVideoId = videoId;
      titleEl.textContent = title;
      player.loadVideoById(videoId);
      isPlaying = true;
      playBtn.textContent = '‚è∏Ô∏è';
      updateProgressLoop();
      
      // Add visual feedback
      titleEl.style.animation = 'none';
      setTimeout(() => {
        titleEl.style.animation = 'trackSlide 15s linear infinite';
      }, 10);
    }

    playBtn.onclick = () => {
      if (!currentVideoId) return;
      if (isPlaying) {
        player.pauseVideo();
      } else {
        player.playVideo();
      }
    };

    function onPlayerStateChange(e) {
      if (e.data === YT.PlayerState.PLAYING) {
        isPlaying = true;
        playBtn.textContent = '‚è∏Ô∏è';
        const total = player.getDuration();
        durTime.textContent = formatTime(total);
      }
      if (e.data === YT.PlayerState.PAUSED || e.data === YT.PlayerState.ENDED) {
        isPlaying = false;
        playBtn.textContent = '‚ñ∂Ô∏è';
      }
    }

    function updateProgressLoop() {
      if (!currentVideoId) return;
      const elapsed = player.getCurrentTime();
      const total   = player.getDuration();
      currTime.textContent = formatTime(elapsed);
      if (total) {
        progBar.style.width = ((elapsed / total) * 100) + '%';
      }
      if (isPlaying) requestAnimationFrame(updateProgressLoop);
    }

    progCont.onclick = e => {
      if (!currentVideoId) return;
      const rect = progCont.getBoundingClientRect();
      const pct  = (e.clientX - rect.left) / rect.width;
      const seek = player.getDuration() * pct;
      player.seekTo(seek, true);
      updateProgressLoop();
    };

    function formatTime(sec) {
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60).toString().padStart(2, '0');
      return `${m}:${s}`;
    }
    
    // Enter key support for search
    inputEl.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        btn.click();
      }
    });
    // ‚Üì PLAYLIST / FAVS / SHUFFLE / REPEAT / VOLUME ‚Üì
let playlist = JSON.parse(localStorage.getItem('playlist') || '[]');
let currentIndex = -1, shuffleMode = false, repeatMode = false;
const favorites = JSON.parse(localStorage.getItem('ytFavs')||'[]');
renderPlaylist();

function addToPlaylist(id,title){ playlist.push({id,title}); }
function saveFavorites(){ localStorage.setItem('ytFavs',JSON.stringify(favorites)); }
function updateFavIcon(){
  if(currentIndex<0) return;
  const track=playlist[currentIndex];
  favBtn.textContent = favorites.some(f=>f.id===track.id)?'üíõ':'‚≠ê';
}
function toggleFavorite(){
  if(currentIndex<0) return;
  const track=playlist[currentIndex];
  const idx=favorites.findIndex(f=>f.id===track.id);
  idx>=0 ? favorites.splice(idx,1) : favorites.push(track);
  saveFavorites(); updateFavIcon();
}

// grab new buttons/slider
const prevBtn    = document.getElementById('prev-track');
const nextBtn    = document.getElementById('next-track');
const shuffleBtn = document.getElementById('shuffle');
const repeatBtn  = document.getElementById('repeat');
const favBtn     = document.getElementById('favorite');
const volSlider  = document.getElementById('volume-slider');

prevBtn.onclick = () => {
  if(!playlist.length) return;
  currentIndex=(currentIndex-1+playlist.length)%playlist.length;
  const t=playlist[currentIndex]; loadTrack(t.id,t.title);
};
nextBtn.onclick = () => {
  if(!playlist.length) return;
  shuffleMode
    ? currentIndex=Math.floor(Math.random()*playlist.length)
    : currentIndex=(currentIndex+1)%playlist.length;
  const t=playlist[currentIndex]; loadTrack(t.id,t.title);
};
shuffleBtn.onclick = () => {
  shuffleMode = !shuffleMode;
  shuffleBtn.style.opacity = shuffleMode?'1':'0.5';
};
repeatBtn.onclick = () => {
  repeatMode = !repeatMode;
  repeatBtn.style.opacity = repeatMode?'1':'0.5';
};
volSlider.oninput = () => player.setVolume(volSlider.value);
favBtn.onclick    = toggleFavorite;

// augment loadTrack & end-of-track behavior
const _load = loadTrack;
loadTrack = (id,title) => {
  if(currentIndex<0||playlist[currentIndex]?.id!==id){
    addToPlaylist(id,title); currentIndex=playlist.length-1;
  }
  _load(id,title); updateFavIcon(); updateProgressLoop();
};
const _onState = onPlayerStateChange;
onPlayerStateChange = e => {
  if(e.data===YT.PlayerState.ENDED){
    repeatMode ? player.playVideo() : nextBtn.click();
  }
  _onState(e);
};
// ‚Üë END PLAYLIST / FAVS / SHUFFLE / REPEAT / VOLUME ‚Üë
// ‚Äî Playlist UI & Sequential Play ‚Äî
const playlistEl = document.getElementById('playlist');

function renderPlaylist() {
  playlistEl.innerHTML = '';
  playlist.forEach((t, i) => {
    const li = document.createElement('li');
    li.textContent = t.title;
    li.onclick = () => {
      currentIndex = i;
      loadTrack(t.id, t.title);
    };

    const btn = document.createElement('button');
    btn.textContent = '√ó';
    btn.className = 'remove';
    btn.onclick = e => {
      e.stopPropagation();
      playlist.splice(i, 1);
      if (i === currentIndex) currentIndex--;
      // ‚Üê SAVE UPDATED PLAYLIST TO localStorage:
      localStorage.setItem('playlist', JSON.stringify(playlist));
      renderPlaylist();
    };

    li.appendChild(btn);
    playlistEl.appendChild(li);
  });
}


// attach ‚Äúadd to playlist‚Äù handlers after results are rendered
function attachAddButtons() {
  document.querySelectorAll('.add-to-playlist').forEach((btn, idx) => {
    btn.onclick = e => {
      e.stopPropagation();
      const item = playlistItems[idx];
          playlist.push({ id: item.id.videoId, title: item.snippet.title });
    localStorage.setItem('playlist', JSON.stringify(playlist));
    renderPlaylist();

    };
  });
}

// store last search items for add-to-playlist references
let playlistItems = [];
// in your search code, after `items.forEach(...)`, add:
playlistItems = items;
attachAddButtons();

// modify end-of-track logic to advance within playlist
const origOnEnd = onPlayerStateChange;
onPlayerStateChange = e => {
  if (e.data === YT.PlayerState.ENDED) {
    if (repeatMode) player.playVideo();
    else if (shuffleMode) nextBtn.click();
    else {
      // sequential
      if (currentIndex + 1 < playlist.length) {
        currentIndex++;
        const t = playlist[currentIndex];
        loadTrack(t.id, t.title);
      }
    }
  }
  origOnEnd(e);
};

  </script>
</body>
</html>
